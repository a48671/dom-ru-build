(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(t,e,n){t.exports=n(40)},40:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(12),c=n(9),i=n(10),u=n(11),l=n.n(u),s=n(14),f=n(4),p=n(5),d=n(7),m=n(6),h=n(8),g=n(15),v=function(t){var e=new Date(t).getFullYear(),n=new Date(t),a=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,r=new Date(t).getDate();return"".concat(e,"-").concat(a,"-").concat(r)},O=n(22),b=n(1),w=n.n(b),j=function(t){return w()(t.start.toString()).valueOf()},x=function(t){return w()(t.start.toString()).valueOf()+1e3*t.duration},y=Object(O.a)(function(t){return t.data},function(t){return t.currentDate},function(t,e){return t.reduce(function(t,n,a,r){var o=n.start.split(" ")[1].split(":"),u="".concat(o[0],":").concat(o[1]);return j(n)>e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"inFuture",time:u,end:x(n)})]):j(n)<=e&&x(n)>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isNow",time:u,end:x(n)})]):x(n)<e&&x(r[a+1])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isOver",time:u,end:x(n)})]):x(n)<e&&x(r[a+1])<e&&x(r[a+2])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isPast",time:u,end:x(n)})]):Object(c.a)(t)},[])}),S=n(2),N=n(3),k="#aeaeae",E="#fff",I="blue",D="#c7e6fd",T="pink",_="#333";function P(){var t=Object(S.a)(["\n\tdisplay: block;\n\twidth: 100%;\n\tmax-width: 500px;\n\tmax-height: 100vh;\n\tbackground-color:",";\n"]);return P=function(){return t},t}function J(){var t=Object(S.a)(["\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\twidth: 100%;\n\tmin-height: 100vh;\n\toverflow: hidden;\n\tbackground-color: ",";\n"]);return J=function(){return t},t}var z=N.a.div.attrs({className:"wrapper"})(J(),k),C=N.a.div.attrs({className:"container"})(P(),E);function F(){var t=Object(S.a)(["\n\twidth: calc(100% - 70px);\n\tfont-size: 24px;\n\tfont-weight: 600;\n\tpadding-left: 30px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration: underline;\n\t}\n\t@media (max-width: 430px) {\n         font-size: 22px;\n  \t}\n"]);return F=function(){return t},t}function M(){var t=Object(S.a)(["\n\twidth: 70px;\n\theight: 70px;\n\timg {\n\t\tmax-width: 100%;\n\t\tmax-height: 100%;\n\t}\n"]);return M=function(){return t},t}function U(){var t=Object(S.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\twidth: 100%;\n\tpadding: 10px 20px;\n"]);return U=function(){return t},t}var A=N.a.div.attrs({className:"head"})(U()),R=N.a.div.attrs({className:"head__logo"})(M()),B=N.a.h1.attrs({className:"head__title"})(F(),I),Y=function(t){function e(){return Object(f.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.logo,a=t.url;return r.a.createElement(A,null,r.a.createElement(R,null,r.a.createElement("img",{src:n,alt:e})),r.a.createElement(B,null,r.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},e)))}}]),e}(a.PureComponent);Y.defaultProps={title:"",logo:"",url:""};var q=Y;function G(){var t=Object(S.a)(["\n\toverflow-y: auto;\n\toverflow-x: hidden;\n\tmax-height: calc(100vh - 90px);\n"]);return G=function(){return t},t}var H=N.a.div.attrs({className:"telecast-list"})(G());function K(){var t=Object(S.a)(["\n\twidth: calc(100% - 70px);\n\tfont-size: 20px;\n\tfont-weight: 600;\n\tcolor: ",";\n\tpadding-left: 15px;\n\toverflow: hidden;\n\t@media (max-width: 430px) {\n         font-size: 18px;\n  \t}\n"]);return K=function(){return t},t}function L(){var t=Object(S.a)(["\n\twidth: 55px;\n\tfont-size: 22px;\n\t@media (max-width: 430px) {\n         font-size: 20px;\n  \t}\n"]);return L=function(){return t},t}function Q(){var t=Object(S.a)(["\n\tdisplay: flex;\n\tpadding: 10px 20px;\n\talign-items: flex-start;\n\tborder-bottom: 1px solid ",";\n\tbackground-color: ",";\n\t",";\n"]);return Q=function(){return t},t}var V=N.a.div.attrs({className:"telecast-item"})(Q(),k,function(t){return"isNow"===t.type?D:"isOver"===t.type?T:"initial"},function(t){return"isPast"===t.type?"opacity: 0.3":null}),W=N.a.div.attrs({className:"telecast-time"})(L()),X=N.a.h1.attrs({className:"head__title"})(K(),_),Z=function(t){function e(){return Object(f.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.time,a=t.type;return r.a.createElement(V,{type:a},r.a.createElement(W,null,n),r.a.createElement(X,null,e))}}]),e}(a.PureComponent);Z.defaultProps={title:"",img:"",altImg:"",type:"inFuture"};var $=Z,tt=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).renderItems=function(){return n.props.info.map(function(t){return r.a.createElement($,{key:t.start+Math.random(),title:t.title,time:t.time,type:t.type})})},n}return Object(h.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){return r.a.createElement(H,null,this.renderItems())}}]),e}(a.PureComponent);tt.defaultProps={info:[],currentDate:Date.parse(new Date)};var et=tt,nt="148",at="perm",rt="https://epg.domru.ru",ot=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(r)))).state={title:"",logo:"",url:"",info:[]},n.getInfoProgramm=Object(s.a)(l.a.mark(function t(){var e;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((e=JSON.parse(window.localStorage.getItem("info")))&&e.title&&e.logo&&e.url)){t.next=4;break}return n.setState({title:e.title,logo:e.logo,url:e.url}),t.abrupt("return");case 4:new g.a(function(t,e){fetch("".concat(rt,"/channel/info?chid=").concat(nt,"&domain=").concat(at)).then(function(t){return t.json()}).then(function(e){return t(e)}).catch(function(t){return e(t)})}).then(function(t){n.setState({title:t.title,logo:rt+t.logo,url:t.url}),window.localStorage.setItem("info",JSON.stringify(n.state))}).catch(function(t){return console.log(t)});case 6:case"end":return t.stop()}},t)})),n.getTelecasts=Object(s.a)(l.a.mark(function t(){var e,a,r,o,u,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=w()().valueOf(),a="".concat(v(e-864e5),"+").concat(encodeURIComponent("18:00:00")),r="".concat(v(e),"+").concat(encodeURIComponent("23:59:59")),o=JSON.parse(window.localStorage.getItem("rangeDate")),u=JSON.parse(window.localStorage.getItem("info")),!(o&&u&&o.from<=e&&o.to>=e)){t.next=10;break}return s=y({data:u.info,currentDate:e}),n.setState(Object(i.a)({},u,{info:Object(c.a)(s)})),n.allUpdate(s),t.abrupt("return");case 10:new g.a(function(t,e){fetch("".concat(rt,"/program/list?date_from=").concat(a,"&date_to=").concat(r,"&xvid[0]=1&chid=").concat(nt,"&domain=").concat(at)).then(function(t){return t.json()}).then(function(e){return t(e)}).catch(function(t){return e(t)})}).then(function(t){var e=t[1],a=w()().valueOf();n.setState({info:y({data:e,currentDate:a})}),window.localStorage.setItem("info",JSON.stringify(n.state)),window.localStorage.setItem("rangeDate",JSON.stringify({from:w()(v(a-864e5)+"T18:00:0",w.a.ISO_8601).valueOf(),to:w()(v(a)+"T23:59:59",w.a.ISO_8601).valueOf()})),n.allUpdate(n.state.info)}).catch(function(t){return console.log(t)});case 12:case"end":return t.stop()}},t)})),n.allUpdate=function(t){var e=w()().valueOf();n.updateFromServer(e,w()(v(e)+" 23:59:59").valueOf()),n.updateTelecasts(t,e)},n.updateTelecasts=function(t,e){var a=t[2].end-e+1e3;console.log("Next update from state: ",a/1e3/60," min");var r=setTimeout(function(){console.log("updating from state"),clearTimeout(r),n.setState({info:y({data:t,currentDate:w()().valueOf()})}),n.updateTelecasts(n.state.info,w()().valueOf())},a)},n.updateFromServer=function(t,e){var a=e-t+1e3;console.log("Next update from server: ",a/1e3/60/60," hours");var r=setTimeout(function(){console.log("updating from server"),clearTimeout(r),n.getTelecasts()},a)},n}return Object(h.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){this.getInfoProgramm(),this.getTelecasts()}},{key:"render",value:function(){var t=this.state,e=t.title,n=t.logo,a=t.url,o=t.info;return r.a.createElement(z,null,r.a.createElement(C,null,r.a.createElement(q,{title:e,logo:n,url:a}),r.a.createElement(et,{info:o})))}}]),e}(a.Component);Object(o.render)(r.a.createElement(ot,null),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.c38c50d1.chunk.js.map