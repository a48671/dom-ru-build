{"version":3,"sources":["helpers/formatDate.js","helpers/reduceTelecasts.js","variables/colors.js","styled.js","components/Head/styled.js","components/Head/index.js","components/TelecastList/styled.js","components/TelecastList/TelecastItem/styled.js","components/TelecastList/TelecastItem/index.js","components/TelecastList/index.js","App.js","index.js"],"names":["formatDate","date","year","Date","getFullYear","currentMonth","month","getMonth","day","getDate","concat","telecastDateStart","telecast","momentum","start","toString","valueOf","telecastDateEnd","duration","reduceTelecasts","createSelector","state","data","currentDate","reduce","acc","index","array","timeArray","split","time","Object","toConsumableArray","objectSpread","type","end","colors","Wrapper","styled","div","attrs","className","_templateObject","Container","_templateObject2","styled_templateObject","Logo","styled_templateObject2","Title","h1","_templateObject3","Head","_this$props","this","props","title","logo","url","react_default","a","createElement","styled_Wrapper","src","alt","href","target","rel","PureComponent","defaultProps","TelecastList_styled_templateObject","TelecastItem_styled_templateObject","Time","TelecastItem_styled_templateObject2","styled_templateObject3","TelecastItem","TelecastItem_styled_Wrapper","styled_Title","img","altImg","TelecastList","renderItems","_this","info","map","TelecastList_TelecastItem","key","Math","random","TelecastList_styled_Wrapper","parse","chid","domain","urlAPI","App","getInfoProgramm","_callee","localInfo","responce","regenerator_default","wrap","_context","prev","next","JSON","window","localStorage","getItem","setState","abrupt","axios","get","sent","setItem","stringify","t0","console","log","stop","getTelecasts","_callee2","from","to","dateRange","newTelecastsList","telecasts","_currentDate","_context2","moment","encodeURIComponent","allUpdate","ISO_8601","updateFromServer","updateTelecasts","nextUpdate","update","setTimeout","clearTimeout","_this$state","components_Head","components_TelecastList","Component","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.66611d45.chunk.js","sourcesContent":["export const formatDate = date => {\n  const year = new Date(date).getFullYear()\n  const currentMonth = new Date(date)\n  const month =\n    currentMonth.getMonth() + 1 < 10\n      ? '0' + (currentMonth.getMonth() + 1)\n      : currentMonth.getMonth() + 1\n  const day = new Date(date).getDate()\n\n  return `${year}-${month}-${day}`\n}\n","import { createSelector } from 'reselect'\nimport momentum from 'moment'\n\nconst telecastDateStart = telecast =>\n  momentum(telecast.start.toString()).valueOf()\nconst telecastDateEnd = telecast =>\n  momentum(telecast.start.toString()).valueOf() + telecast.duration * 1000\n\nexport const reduceTelecasts = createSelector(\n  state => state.data,\n  state => state.currentDate,\n  (data, currentDate) =>\n    data.reduce((acc, telecast, index, array) => {\n      const timeArray = telecast.start.split(' ')[1].split(':')\n      const time = `${timeArray[0]}:${timeArray[1]}`\n\n      if (telecastDateStart(telecast) > currentDate) {\n        return [\n          ...acc,\n          {\n            ...telecast,\n            type: 'inFuture',\n            time: time,\n            end: telecastDateEnd(telecast),\n          },\n        ]\n      }\n      if (\n        telecastDateStart(telecast) <= currentDate &&\n        telecastDateEnd(telecast) >= currentDate\n      ) {\n        return [\n          ...acc,\n          {\n            ...telecast,\n            type: 'isNow',\n            time: time,\n            end: telecastDateEnd(telecast),\n          },\n        ]\n      }\n      if (\n        telecastDateEnd(telecast) < currentDate &&\n        telecastDateEnd(array[index + 1]) >= currentDate\n      ) {\n        return [\n          ...acc,\n          {\n            ...telecast,\n            type: 'isOver',\n            time: time,\n            end: telecastDateEnd(telecast),\n          },\n        ]\n      }\n      if (\n        telecastDateEnd(telecast) < currentDate &&\n        telecastDateEnd(array[index + 1]) < currentDate &&\n        telecastDateEnd(array[index + 2]) >= currentDate\n      ) {\n        return [\n          ...acc,\n          {\n            ...telecast,\n            type: 'isPast',\n            time: time,\n            end: telecastDateEnd(telecast),\n          },\n        ]\n      } else return [...acc]\n    }, [])\n)\n","export const colors = {\n\tgray: '#aeaeae',\n\twhite: '#fff',\n\tgreen: 'green',\n\tblue: 'blue',\n\tblueLight: '#c7e6fd',\n\tpink: 'pink',\n\tdark: '#333'\n}","import styled from 'styled-components';\nimport {colors} from './variables/colors';\n\nexport const Wrapper = styled.div.attrs({className: 'wrapper'})`\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\twidth: 100%;\n\tmin-height: 100vh;\n\toverflow: hidden;\n\tbackground-color: ${colors.gray};\n`;\n\nexport const Container = styled.div.attrs({className: 'container'})`\n\tdisplay: block;\n\twidth: 100%;\n\tmax-width: 500px;\n\tmax-height: 100vh;\n\tbackground-color:${colors.white};\n`;","import styled from 'styled-components';\nimport {colors} from '../../variables/colors';\n\nexport const Wrapper = styled.div.attrs({className: 'head'})`\n\tdisplay: flex;\n\talign-items: center;\n\twidth: 100%;\n\tpadding: 10px 20px;\n`;\n\nexport const Logo = styled.div.attrs({className: 'head__logo'})`\n\twidth: 70px;\n\theight: 70px;\n\timg {\n\t\tmax-width: 100%;\n\t\tmax-height: 100%;\n\t}\n`;\n\nexport const Title = styled.h1.attrs({className: 'head__title'})`\n\twidth: calc(100% - 70px);\n\tfont-size: 24px;\n\tfont-weight: 600;\n\tpadding-left: 30px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\ta {\n\t\tcolor: ${colors.blue};\n\t\ttext-decoration: underline;\n\t}\n\t@media (max-width: 430px) {\n         font-size: 22px;\n  \t}\n`;\n","import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {Wrapper, Logo, Title} from './styled';\n\nclass Head extends PureComponent {\n\trender() {\n\n\t\tconst {title, logo, url} = this.props;\n\n\t\treturn (\n\t\t\t<Wrapper>\n\t\t\t\t<Logo>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={logo}\n\t\t\t\t\t     alt={title}\n\t\t\t\t\t/>\n\t\t\t\t</Logo>\n\t\t\t\t<Title>\n\t\t\t\t\t<a\n\t\t\t\t\t\thref={url}\n\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</a>\n\t\t\t\t</Title>\n\t\t\t</Wrapper>\n\t\t);\n\t}\n}\n\nHead.propTypes = {\n\ttitle: PropTypes.string,\n\tlogo: PropTypes.string,\n\turl: PropTypes.string\n};\n\nHead.defaultProps = {\n\ttitle: '',\n\tlogo: '',\n\turl: ''\n};\n\nexport default Head;","import styled from 'styled-components';\n\nexport const Wrapper = styled.div.attrs({className: 'telecast-list'})`\n\toverflow-y: auto;\n\toverflow-x: hidden;\n\tmax-height: calc(100vh - 90px);\n`;","import styled from 'styled-components';\nimport {colors} from '../../../variables/colors';\n\nexport const Wrapper = styled.div.attrs({className: 'telecast-item'})`\n\tdisplay: flex;\n\tpadding: 10px 20px;\n\talign-items: flex-start;\n\tborder-bottom: 1px solid ${colors.gray};\n\tbackground-color: ${\n\t\tprops => {\n\t\t\tif(props.type === 'isNow') return colors.blueLight;\n\t\t\tif(props.type === 'isOver') return colors.pink;\n\t\t\telse return 'initial';\n\t\t}\n\t};\n\t${props => {\n\t\treturn props.type === 'isPast' ? 'opacity: 0.3' : null\n\t}};\n`;\n\nexport const Time = styled.div.attrs({className: 'telecast-time'})`\n\twidth: 55px;\n\tfont-size: 22px;\n\t@media (max-width: 430px) {\n         font-size: 20px;\n  \t}\n`;\n\nexport const Title = styled.h1.attrs({className: 'head__title'})`\n\twidth: calc(100% - 70px);\n\tfont-size: 20px;\n\tfont-weight: 600;\n\tcolor: ${colors.dark};\n\tpadding-left: 15px;\n\toverflow: hidden;\n\t@media (max-width: 430px) {\n         font-size: 18px;\n  \t}\n`;","import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {Wrapper, Time, Title} from './styled'\n\nclass TelecastItem extends PureComponent {\n\trender() {\n\n\t\tconst {title, time, type} = this.props;\n\n\t\treturn (\n\t\t\t<Wrapper type={type}>\n\t\t\t\t<Time>\n\t\t\t\t\t{time}\n\t\t\t\t</Time>\n\t\t\t\t<Title>\n\t\t\t\t\t{title}\n\t\t\t\t</Title>\n\t\t\t</Wrapper>\n\t\t);\n\t}\n}\n\nTelecastItem.propTypes = {\n\ttitle: PropTypes.string,\n\ttime: PropTypes.string,\n\ttype: PropTypes.string\n};\n\nTelecastItem.defaultProps = {\n\ttitle: '',\n\timg: '',\n\taltImg: '',\n\ttype: 'inFuture'\n};\n\nexport default TelecastItem;","import React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {Wrapper} from './styled';\nimport TelecastItem from \"./TelecastItem\";\n\nclass TelecastList extends PureComponent {\n\n\trender() {\n\n\t\treturn (\n\t\t\t<Wrapper>\n\t\t\t\t{this.renderItems()}\n\t\t\t</Wrapper>\n\t\t);\n\t}\n\n\trenderItems = () => {\n\n\t\tconst {info} = this.props;\n\n\t\treturn(\n\t\t\tinfo.map((telecast) => {\n\n\t\t\t\treturn(\n\t\t\t\t\t<TelecastItem\n\t\t\t\t\t\tkey={telecast.start + Math.random()}\n\t\t\t\t\t\ttitle={telecast.title}\n\t\t\t\t\t\ttime={telecast.time}\n\t\t\t\t\t\ttype={telecast.type} // isNow, isOver, inFuture, isPast\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t};\n\n}\n\nTelecastList.propTypes = {\n\tinfo: PropTypes.arrayOf(PropTypes.object),\n\tcurrentDate: PropTypes.number\n};\n\nTelecastList.defaultProps = {\n\tinfo: [],\n\tcurrentDate: Date.parse(new Date())\n};\n\nexport default TelecastList;","import React, { Component } from 'react';\nimport axios from 'axios';\nimport { formatDate } from './helpers/formatDate';\nimport { reduceTelecasts } from './helpers/reduceTelecasts';\nimport moment from 'moment';\n\nimport { Wrapper, Container } from './styled';\n\nimport Head from './components/Head';\nimport TelecastList from './components/TelecastList';\n\nconst chid = '148';\nconst domain = 'perm';\nconst urlAPI = 'https://epg.domru.ru';\n\nclass App extends Component {\n  state = {\n    title: '',\n    logo: '',\n    url: '',\n    info: [],\n  };\n\n  componentDidMount() {\n    this.getInfoProgramm();\n    this.getTelecasts();\n  }\n\n  getInfoProgramm = async () => {\n    const localInfo = JSON.parse(window.localStorage.getItem('info'));\n\n    if (localInfo && localInfo.title && localInfo.logo && localInfo.url) {\n      this.setState({\n        title: localInfo.title,\n        logo: localInfo.logo,\n        url: localInfo.url,\n      });\n\n      return;\n    }\n\n    try {\n      const responce = await axios.get(\n        `${urlAPI}/channel/info?chid=${chid}&domain=${domain}`\n      );\n\n      const data = responce.data;\n\n      this.setState({\n        title: data.title,\n        logo: urlAPI + data.logo,\n        url: data.url,\n      });\n\n      window.localStorage.setItem('info', JSON.stringify(this.state));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  getTelecasts = async () => {\n    const currentDate = moment().valueOf();\n\n    const from = `${formatDate(currentDate - 86400000)}+${encodeURIComponent(\n      '18:00:00'\n    )}`;\n    const to = `${formatDate(currentDate)}+${encodeURIComponent('23:59:59')}`;\n\n    const dateRange = JSON.parse(window.localStorage.getItem('rangeDate'));\n    const localInfo = JSON.parse(window.localStorage.getItem('info'));\n\n    if (\n      dateRange &&\n      localInfo &&\n      dateRange.from <= currentDate &&\n      dateRange.to >= currentDate\n    ) {\n      const newTelecastsList = reduceTelecasts({\n        data: localInfo.info,\n        currentDate,\n      });\n\n      this.setState({\n        ...localInfo,\n        info: [...newTelecastsList],\n      });\n\n      this.allUpdate(newTelecastsList);\n\n      return;\n    }\n\n    try {\n      const responce = await axios.get(\n        `${urlAPI}/program/list?date_from=${from}&date_to=${to}&xvid[0]=1&chid=${chid}&domain=${domain}`\n      );\n\n      const telecasts = responce.data[1];\n\n      const currentDate = moment().valueOf();\n\n      this.setState({\n        info: reduceTelecasts({ data: telecasts, currentDate: currentDate }),\n      });\n\n      window.localStorage.setItem('info', JSON.stringify(this.state));\n\n      window.localStorage.setItem(\n        'rangeDate',\n        JSON.stringify({\n          from: moment(\n            formatDate(currentDate - 86400000) + 'T18:00:0',\n            moment.ISO_8601\n          ).valueOf(),\n          to: moment(\n            formatDate(currentDate) + 'T23:59:59',\n            moment.ISO_8601\n          ).valueOf(),\n        })\n      );\n\n      this.allUpdate(this.state.info);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  allUpdate = info => {\n    const currentDate = moment().valueOf();\n\n    this.updateFromServer(\n      currentDate,\n      moment(formatDate(currentDate) + ' 23:59:59').valueOf()\n    );\n\n    this.updateTelecasts(info, currentDate);\n  };\n\n  updateTelecasts = (info, currentDate) => {\n    const nextUpdate = info[2].end - currentDate + 1000;\n\n    console.log('Next update from state: ', nextUpdate / 1000 / 60, ' min');\n\n    const update = setTimeout(() => {\n      console.log('updating from state');\n      clearTimeout(update);\n      this.setState({\n        info: reduceTelecasts({ data: info, currentDate: moment().valueOf() }),\n      });\n      this.updateTelecasts(this.state.info, moment().valueOf());\n    }, nextUpdate);\n  };\n\n  updateFromServer = (currentDate, to) => {\n    const nextUpdate = to - currentDate + 1000;\n\n    console.log(\n      'Next update from server: ',\n      nextUpdate / 1000 / 60 / 60,\n      ' hours'\n    );\n\n    const update = setTimeout(() => {\n      console.log('updating from server');\n      clearTimeout(update);\n      this.getTelecasts();\n    }, nextUpdate);\n  };\n\n  render() {\n    const { title, logo, url, info } = this.state;\n\n    return (\n      <Wrapper>\n        <Container>\n          <Head title={title} logo={logo} url={url} />\n          <TelecastList info={info} />\n        </Container>\n      </Wrapper>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport {render} from 'react-dom';\n\nimport App from './App';\n\nrender(<App />, document.getElementById('root'));"],"sourceRoot":""}