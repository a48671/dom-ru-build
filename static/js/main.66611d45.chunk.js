(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(t,e,n){t.exports=n(62)},62:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(13),c=n(10),i=n(11),l=n(12),u=n.n(l),s=n(15),f=n(5),p=n(6),d=n(8),m=n(7),v=n(9),g=n(16),h=n.n(g),O=function(t){var e=new Date(t).getFullYear(),n=new Date(t),a=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,r=new Date(t).getDate();return"".concat(e,"-").concat(a,"-").concat(r)},b=n(27),w=n(1),x=n.n(w),j=function(t){return x()(t.start.toString()).valueOf()},y=function(t){return x()(t.start.toString()).valueOf()+1e3*t.duration},S=Object(b.a)(function(t){return t.data},function(t){return t.currentDate},function(t,e){return t.reduce(function(t,n,a,r){var o=n.start.split(" ")[1].split(":"),l="".concat(o[0],":").concat(o[1]);return j(n)>e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"inFuture",time:l,end:y(n)})]):j(n)<=e&&y(n)>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isNow",time:l,end:y(n)})]):y(n)<e&&y(r[a+1])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isOver",time:l,end:y(n)})]):y(n)<e&&y(r[a+1])<e&&y(r[a+2])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isPast",time:l,end:y(n)})]):Object(c.a)(t)},[])}),k=n(2),N=n(3),E="#aeaeae",I="#fff",D="blue",T="#c7e6fd",_="pink",P="#333";function J(){var t=Object(k.a)(["\n\tdisplay: block;\n\twidth: 100%;\n\tmax-width: 500px;\n\tmax-height: 100vh;\n\tbackground-color:",";\n"]);return J=function(){return t},t}function z(){var t=Object(k.a)(["\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\twidth: 100%;\n\tmin-height: 100vh;\n\toverflow: hidden;\n\tbackground-color: ",";\n"]);return z=function(){return t},t}var C=N.a.div.attrs({className:"wrapper"})(z(),E),F=N.a.div.attrs({className:"container"})(J(),I);function M(){var t=Object(k.a)(["\n\twidth: calc(100% - 70px);\n\tfont-size: 24px;\n\tfont-weight: 600;\n\tpadding-left: 30px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\ta {\n\t\tcolor: ",";\n\t\ttext-decoration: underline;\n\t}\n\t@media (max-width: 430px) {\n         font-size: 22px;\n  \t}\n"]);return M=function(){return t},t}function U(){var t=Object(k.a)(["\n\twidth: 70px;\n\theight: 70px;\n\timg {\n\t\tmax-width: 100%;\n\t\tmax-height: 100%;\n\t}\n"]);return U=function(){return t},t}function A(){var t=Object(k.a)(["\n\tdisplay: flex;\n\talign-items: center;\n\twidth: 100%;\n\tpadding: 10px 20px;\n"]);return A=function(){return t},t}var R=N.a.div.attrs({className:"head"})(A()),B=N.a.div.attrs({className:"head__logo"})(U()),Y=N.a.h1.attrs({className:"head__title"})(M(),D),q=function(t){function e(){return Object(f.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(v.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.logo,a=t.url;return r.a.createElement(R,null,r.a.createElement(B,null,r.a.createElement("img",{src:n,alt:e})),r.a.createElement(Y,null,r.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},e)))}}]),e}(a.PureComponent);q.defaultProps={title:"",logo:"",url:""};var G=q;function H(){var t=Object(k.a)(["\n\toverflow-y: auto;\n\toverflow-x: hidden;\n\tmax-height: calc(100vh - 90px);\n"]);return H=function(){return t},t}var K=N.a.div.attrs({className:"telecast-list"})(H());function L(){var t=Object(k.a)(["\n\twidth: calc(100% - 70px);\n\tfont-size: 20px;\n\tfont-weight: 600;\n\tcolor: ",";\n\tpadding-left: 15px;\n\toverflow: hidden;\n\t@media (max-width: 430px) {\n         font-size: 18px;\n  \t}\n"]);return L=function(){return t},t}function Q(){var t=Object(k.a)(["\n\twidth: 55px;\n\tfont-size: 22px;\n\t@media (max-width: 430px) {\n         font-size: 20px;\n  \t}\n"]);return Q=function(){return t},t}function V(){var t=Object(k.a)(["\n\tdisplay: flex;\n\tpadding: 10px 20px;\n\talign-items: flex-start;\n\tborder-bottom: 1px solid ",";\n\tbackground-color: ",";\n\t",";\n"]);return V=function(){return t},t}var W=N.a.div.attrs({className:"telecast-item"})(V(),E,function(t){return"isNow"===t.type?T:"isOver"===t.type?_:"initial"},function(t){return"isPast"===t.type?"opacity: 0.3":null}),X=N.a.div.attrs({className:"telecast-time"})(Q()),Z=N.a.h1.attrs({className:"head__title"})(L(),P),$=function(t){function e(){return Object(f.a)(this,e),Object(d.a)(this,Object(m.a)(e).apply(this,arguments))}return Object(v.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.time,a=t.type;return r.a.createElement(W,{type:a},r.a.createElement(X,null,n),r.a.createElement(Z,null,e))}}]),e}(a.PureComponent);$.defaultProps={title:"",img:"",altImg:"",type:"inFuture"};var tt=$,et=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(o)))).renderItems=function(){return n.props.info.map(function(t){return r.a.createElement(tt,{key:t.start+Math.random(),title:t.title,time:t.time,type:t.type})})},n}return Object(v.a)(e,t),Object(p.a)(e,[{key:"render",value:function(){return r.a.createElement(K,null,this.renderItems())}}]),e}(a.PureComponent);et.defaultProps={info:[],currentDate:Date.parse(new Date)};var nt=et,at="148",rt="perm",ot="https://epg.domru.ru",ct=function(t){function e(){var t,n;Object(f.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(d.a)(this,(t=Object(m.a)(e)).call.apply(t,[this].concat(r)))).state={title:"",logo:"",url:"",info:[]},n.getInfoProgramm=Object(s.a)(u.a.mark(function t(){var e,a,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((e=JSON.parse(window.localStorage.getItem("info")))&&e.title&&e.logo&&e.url)){t.next=4;break}return n.setState({title:e.title,logo:e.logo,url:e.url}),t.abrupt("return");case 4:return t.prev=4,t.next=7,h.a.get("".concat(ot,"/channel/info?chid=").concat(at,"&domain=").concat(rt));case 7:a=t.sent,r=a.data,n.setState({title:r.title,logo:ot+r.logo,url:r.url}),window.localStorage.setItem("info",JSON.stringify(n.state)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),console.log(t.t0);case 16:case"end":return t.stop()}},t,null,[[4,13]])})),n.getTelecasts=Object(s.a)(u.a.mark(function t(){var e,a,r,o,l,s,f,p,d;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=x()().valueOf(),a="".concat(O(e-864e5),"+").concat(encodeURIComponent("18:00:00")),r="".concat(O(e),"+").concat(encodeURIComponent("23:59:59")),o=JSON.parse(window.localStorage.getItem("rangeDate")),l=JSON.parse(window.localStorage.getItem("info")),!(o&&l&&o.from<=e&&o.to>=e)){t.next=10;break}return s=S({data:l.info,currentDate:e}),n.setState(Object(i.a)({},l,{info:Object(c.a)(s)})),n.allUpdate(s),t.abrupt("return");case 10:return t.prev=10,t.next=13,h.a.get("".concat(ot,"/program/list?date_from=").concat(a,"&date_to=").concat(r,"&xvid[0]=1&chid=").concat(at,"&domain=").concat(rt));case 13:f=t.sent,p=f.data[1],d=x()().valueOf(),n.setState({info:S({data:p,currentDate:d})}),window.localStorage.setItem("info",JSON.stringify(n.state)),window.localStorage.setItem("rangeDate",JSON.stringify({from:x()(O(d-864e5)+"T18:00:0",x.a.ISO_8601).valueOf(),to:x()(O(d)+"T23:59:59",x.a.ISO_8601).valueOf()})),n.allUpdate(n.state.info),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(10),console.log(t.t0);case 25:case"end":return t.stop()}},t,null,[[10,22]])})),n.allUpdate=function(t){var e=x()().valueOf();n.updateFromServer(e,x()(O(e)+" 23:59:59").valueOf()),n.updateTelecasts(t,e)},n.updateTelecasts=function(t,e){var a=t[2].end-e+1e3;console.log("Next update from state: ",a/1e3/60," min");var r=setTimeout(function(){console.log("updating from state"),clearTimeout(r),n.setState({info:S({data:t,currentDate:x()().valueOf()})}),n.updateTelecasts(n.state.info,x()().valueOf())},a)},n.updateFromServer=function(t,e){var a=e-t+1e3;console.log("Next update from server: ",a/1e3/60/60," hours");var r=setTimeout(function(){console.log("updating from server"),clearTimeout(r),n.getTelecasts()},a)},n}return Object(v.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){this.getInfoProgramm(),this.getTelecasts()}},{key:"render",value:function(){var t=this.state,e=t.title,n=t.logo,a=t.url,o=t.info;return r.a.createElement(C,null,r.a.createElement(F,null,r.a.createElement(G,{title:e,logo:n,url:a}),r.a.createElement(nt,{info:o})))}}]),e}(a.Component);Object(o.render)(r.a.createElement(ct,null),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.66611d45.chunk.js.map