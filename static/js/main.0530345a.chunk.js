(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(t,e,n){"use strict";n.r(e);n(62);var a=n(0),r=n.n(a),o=n(27),c=n(11),i=n(15),l=n(6),u=n(7),s=n(9),f=n(8),d=n(10),p=(n(98),function(t){var e=new Date(t).getFullYear(),n=new Date(t),a=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,r=new Date(t).getDate();return"".concat(e,"-").concat(a,"-").concat(r)}),m=n(57),h=n(1),g=n.n(h),v=function(t){return g()(t.start.toString()).valueOf()},O=function(t){return g()(t.start.toString()).valueOf()+1e3*t.duration},b=Object(m.a)(function(t){return t.data},function(t){return t.currentDate},function(t,e){return t.reduce(function(t,n,a,r){var o=n.start.split(" ")[1].split(":"),l="".concat(o[0],":").concat(o[1]);return v(n)>e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"inFuture",time:l,end:O(n)})]):v(n)<=e&&O(n)>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isNow",time:l,end:O(n)})]):O(n)<e&&O(r[a+1])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isOver",time:l,end:O(n)})]):O(n)<e&&O(r[a+1])<e&&O(r[a+2])>=e?[].concat(Object(c.a)(t),[Object(i.a)({},n,{type:"isPast",time:l,end:O(n)})]):Object(c.a)(t)},[])}),w=n(2),j=n(3),x="#aeaeae",y="#fff",S="blue",N="#c7e6fd",E="pink",I="#333";function k(){var t=Object(w.a)(["\n  display: block;\n  width: 100%;\n  max-width: 500px;\n  max-height: 100vh;\n  background-color: ",";\n"]);return k=function(){return t},t}function D(){var t=Object(w.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  min-height: 100vh;\n  overflow: hidden;\n  background-color: ",";\n"]);return D=function(){return t},t}var T=j.a.div.attrs({className:"wrapper"})(D(),x),_=j.a.div.attrs({className:"container"})(k(),y);function P(){var t=Object(w.a)(["\n  width: calc(100% - 70px);\n  font-size: 24px;\n  font-weight: 600;\n  padding-left: 30px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  a {\n    color: ",";\n    text-decoration: underline;\n  }\n  @media (max-width: 430px) {\n    font-size: 22px;\n  }\n"]);return P=function(){return t},t}function J(){var t=Object(w.a)(["\n  width: 70px;\n  height: 70px;\n  img {\n    max-width: 100%;\n    max-height: 100%;\n  }\n"]);return J=function(){return t},t}function z(){var t=Object(w.a)(["\n  display: flex;\n  align-items: center;\n  width: 100%;\n  padding: 10px 20px;\n"]);return z=function(){return t},t}var C=j.a.div.attrs({className:"head"})(z()),F=j.a.div.attrs({className:"head__logo"})(J()),M=j.a.h1.attrs({className:"head__title"})(P(),S),U=function(t){function e(){return Object(l.a)(this,e),Object(s.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.logo,a=t.url;return r.a.createElement(C,null,r.a.createElement(F,null,r.a.createElement("img",{src:n,alt:e})),r.a.createElement(M,null,r.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},e)))}}]),e}(a.PureComponent);U.defaultProps={title:"",logo:"",url:""};var A=U;function R(){var t=Object(w.a)(["\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: calc(100vh - 90px);\n"]);return R=function(){return t},t}var B=j.a.div.attrs({className:"telecast-list"})(R());function Y(){var t=Object(w.a)(["\n  width: calc(100% - 70px);\n  font-size: 20px;\n  font-weight: 600;\n  color: ",";\n  padding-left: 15px;\n  overflow: hidden;\n  @media (max-width: 430px) {\n    font-size: 18px;\n  }\n"]);return Y=function(){return t},t}function q(){var t=Object(w.a)(["\n  width: 55px;\n  font-size: 22px;\n  @media (max-width: 430px) {\n    font-size: 20px;\n  }\n"]);return q=function(){return t},t}function G(){var t=Object(w.a)(["\n  display: flex;\n  padding: 10px 20px;\n  align-items: flex-start;\n  border-bottom: 1px solid ",";\n  background-color: ",";\n  ",";\n"]);return G=function(){return t},t}var H=j.a.div.attrs({className:"telecast-item"})(G(),x,function(t){return"isNow"===t.type?N:"isOver"===t.type?E:"initial"},function(t){return"isPast"===t.type?"opacity: 0.3":null}),K=j.a.div.attrs({className:"telecast-time"})(q()),L=j.a.h1.attrs({className:"head__title"})(Y(),I),Q=function(t){function e(){return Object(l.a)(this,e),Object(s.a)(this,Object(f.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){var t=this.props,e=t.title,n=t.time,a=t.type;return r.a.createElement(H,{type:a},r.a.createElement(K,null,n),r.a.createElement(L,null,e))}}]),e}(a.PureComponent);Q.defaultProps={title:"",img:"",altImg:"",type:"inFuture"};var V=Q,W=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(s.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(o)))).renderItems=function(){return n.props.info.map(function(t){return r.a.createElement(V,{key:t.start+Math.random(),title:t.title,time:t.time,type:t.type})})},n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"render",value:function(){return r.a.createElement(B,null,this.renderItems())}}]),e}(a.PureComponent);W.defaultProps={info:[],currentDate:Date.parse(new Date)};var X=W,Z="148",$="perm",tt="https://epg.domru.ru",et=function(t){function e(){var t,n;Object(l.a)(this,e);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(t=Object(f.a)(e)).call.apply(t,[this].concat(r)))).state={title:"",logo:"",url:"",info:[]},n.getInfoProgramm=function(){var t=JSON.parse(window.localStorage.getItem("info"));t&&t.title&&t.logo&&t.url?n.setState({title:t.title,logo:t.logo,url:t.url}):fetch("".concat(tt,"/channel/info?chid=").concat(Z,"&domain=").concat($)).then(function(t){return t.json()}).then(function(t){n.setState({title:t.title,logo:tt+t.logo,url:t.url}),window.localStorage.setItem("info",JSON.stringify(n.state))}).catch(function(t){return console.log(t)})},n.getTelecasts=function(){var t=g()().valueOf(),e="".concat(p(t-864e5),"+").concat(encodeURIComponent("18:00:00")),a="".concat(p(t),"+").concat(encodeURIComponent("23:59:59")),r=JSON.parse(window.localStorage.getItem("rangeDate")),o=JSON.parse(window.localStorage.getItem("info"));if(r&&o&&r.from<=t&&r.to>=t){var l=b({data:o.info,currentDate:t});return n.setState(Object(i.a)({},o,{info:Object(c.a)(l)})),void n.allUpdate(l)}fetch("".concat(tt,"/program/list?date_from=").concat(e,"&date_to=").concat(a,"&xvid[0]=1&chid=").concat(Z,"&domain=").concat($)).then(function(t){return t.json()}).then(function(t){var e=t[1],a=g()().valueOf();n.setState({info:b({data:e,currentDate:a})}),window.localStorage.setItem("info",JSON.stringify(n.state)),window.localStorage.setItem("rangeDate",JSON.stringify({from:g()(p(a-864e5)+"T18:00:0",g.a.ISO_8601).valueOf(),to:g()(p(a)+"T23:59:59",g.a.ISO_8601).valueOf()})),n.allUpdate(n.state.info)}).catch(function(t){return console.log(t)})},n.allUpdate=function(t){var e=g()().valueOf();n.updateFromServer(e,g()(p(e)+" 23:59:59").valueOf()),n.updateTelecasts(t,e)},n.updateTelecasts=function(t,e){var a=t[2].end-e+1e3;console.log("Next update from state: ",a/1e3/60," min");var r=setTimeout(function(){console.log("updating from state"),clearTimeout(r),n.setState({info:b({data:t,currentDate:g()().valueOf()})}),n.updateTelecasts(n.state.info,g()().valueOf())},a)},n.updateFromServer=function(t,e){var a=e-t+1e3;console.log("Next update from server: ",a/1e3/60/60," hours");var r=setTimeout(function(){console.log("updating from server"),clearTimeout(r),n.getTelecasts()},a)},n}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){this.getInfoProgramm(),this.getTelecasts()}},{key:"render",value:function(){var t=this.state,e=t.title,n=t.logo,a=t.url,o=t.info;return r.a.createElement(T,null,r.a.createElement(_,null,r.a.createElement(A,{title:e,logo:n,url:a}),r.a.createElement(X,{info:o})))}}]),e}(a.Component);Object(o.render)(r.a.createElement(et,null),document.getElementById("root"))},61:function(t,e,n){t.exports=n(105)}},[[61,1,2]]]);
//# sourceMappingURL=main.0530345a.chunk.js.map